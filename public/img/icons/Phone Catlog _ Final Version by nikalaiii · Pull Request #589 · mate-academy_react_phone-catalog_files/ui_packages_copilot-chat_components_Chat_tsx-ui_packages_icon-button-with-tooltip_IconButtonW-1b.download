"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_copilot-chat_components_Chat_tsx-ui_packages_icon-button-with-tooltip_IconButtonW-1ba5d9"],{75095:(e,t,s)=>{s.d(t,{r:()=>eb});var n,i=s(74848),a=s(4460),o=s(46988),r=s(38568),l=s(38621),c=s(75177),d=s(63867),m=s(55847),p=s(84217),u=s(52464),x=s(30729),h=s(96540),g=s(2120),f=s(39363),j=s(82610),y=s(93589),b=s(77342),v=s(2622),C=s(65615),N=s(7426),A=s(56212),_=s(47173);let k={legalText:"Chat-module__legalText--wsTEU"};var w=s(33513),S=s(78176),R=s(56056),T=s(26871),I=s(72160),E=s(8338);let M={ActionList_Heading:"CopilotSuggestions-module__ActionList_Heading--ArthG"},B=({suggestionKind:e})=>{let t=(0,C.Pk)(),s=(0,N.b)(),n=(0,h.useCallback)(e=>{s.sendChatMessage({thread:s.getSelectedThread(t),content:e.prompt??e.question,intent:e.intent,modeOverride:e.mode,references:t.currentReferences,topic:t.currentTopic,context:t.context}),(0,o.BI)("copilot_generated_suggestion_click",{intent:e.intent,mode:e.mode,contextType:t.context?.[0]?.type,content:e.question})},[s,t]),a=(0,h.memo)(function({suggestion:e}){return(0,i.jsxs)(E.l.Item,{onSelect:()=>n(e),sx:{mx:0,border:"1px solid",borderColor:"border.default",width:"fit-content"},children:[(0,i.jsx)(E.l.LeadingVisual,{children:(0,i.jsx)(x.A,{icon:l.PaperAirplaneIcon})}),(0,i.jsxs)("span",{children:[" ",e.question]})]})}),r="loading"===t.messagesLoading.state||!!t.streamingMessage,{suggestions:c}=t,d=t.currentReferences[0],m=1===t.currentReferences.length&&d?.type==="repository"&&d.id===t.currentRepository?.id;return!r&&(v.W.topicsAsReferences?m:!t.showTopicPicker&&0===t.currentReferences.length)&&c&&c.suggestions?(0,i.jsxs)(E.l,{className:"copilot-suggestions",sx:{pt:0,pb:3,display:"flex",gap:2,flexDirection:"column"},children:["initial"===e&&(0,i.jsx)(E.l.Heading,{as:"h2",className:M.ActionList_Heading,children:function(e){return e?`Ask about the ${e.replace(/-/g," ")}:`:"Ask anything:"}(c.referenceType)}),c?.suggestions.map(e=>i.jsx(a,{suggestion:e},e.question))]}):null},z=(0,h.memo)(B);try{B.displayName||(B.displayName="CopilotSuggestions")}catch{}try{(n=CopilotSuggestion).displayName||(n.displayName="CopilotSuggestion")}catch{}var W=s(97891),L=s(89401),D=s(88117),P=s(10871),F=s(87330);let U={container:"CustomBanner-module__container--uV55s",expanded:"CustomBanner-module__expanded--fDTFJ",actions:"CustomBanner-module__actions--tUuz0",iconButton:"CustomBanner-module__iconButton--WWgYX",content:"CustomBanner-module__content--xhiU7",icon:"CustomBanner-module__icon--WrRHA"};function $({icon:e,content:t,actions:s,onDismiss:n}){let a=(0,h.useRef)(null),[o,r]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{let e=a.current;if(!e)return;let t=new ResizeObserver(t=>{for(let s of t)s.target===e&&(s.contentRect.height>40?r(!0):r(!1))});return t.observe(e),()=>{t.disconnect()}},[]),(0,i.jsxs)("div",{ref:a,className:`${U.container} ${o?U.expanded:""}`,children:[(0,i.jsx)("div",{className:U.icon,children:e}),(0,i.jsx)("div",{className:U.content,children:t}),(0,i.jsxs)("div",{className:U.actions,children:[s,n&&(0,i.jsx)(F.K,{className:U.iconButton,variant:"invisible",icon:l.XIcon,size:"medium","aria-label":"Close",onClick:n})]})]})}try{$.displayName||($.displayName="CustomBanner")}catch{}function G(){let{resetDate:e}=(0,D.x)(),t=(0,i.jsx)(l.InfoIcon,{}),s=(0,i.jsxs)(i.Fragment,{children:["You have reached your free plan limit. It will reset on ",e]}),n=(0,i.jsx)(P.z,{as:"a",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,o.BI)("dotcom_chat.activate",{target:"QUOTA_EXCEEDED_BANNER_LINK_UPGRADE",mode:"assistive"})},children:"Upgrade"});return(0,i.jsx)($,{icon:t,content:s,actions:n})}try{G.displayName||(G.displayName="QuotaExceededBanner")}catch{}var O=s(34614);let Q={container:"QuotaExceededEmptyState-module__container--ZMWEG",main:"QuotaExceededEmptyState-module__main--g2hJz",hero:"QuotaExceededEmptyState-module__hero--IrY09",copy:"QuotaExceededEmptyState-module__copy--VyrMt",heading:"QuotaExceededEmptyState-module__heading--LzJGU",description:"QuotaExceededEmptyState-module__description--KbMyl",footer:"QuotaExceededEmptyState-module__footer--evZ9_"};function H(){let{resetDate:e}=(0,D.x)();return(0,i.jsxs)("div",{className:Q.container,children:[(0,i.jsxs)("div",{className:Q.main,children:[(0,i.jsx)("img",{className:Q.hero,src:"/images/modules/copilot-immersive-v1/hero.png",alt:"Hero"}),(0,i.jsxs)("div",{className:Q.copy,children:[(0,i.jsx)("h2",{className:Q.heading,children:"You\u2019ve reached your free plan limit"}),(0,i.jsxs)("p",{className:Q.description,children:["Your limits will reset on ",e,"."]}),(0,i.jsx)(P.z,{as:"a",variant:"primary",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,o.BI)("dotcom_chat.activate",{target:"QUOTA_EXCEEDED_EMPTY_STATE_LINK_UPGRADE",mode:"assistive"})},children:"Upgrade"})]})]}),(0,i.jsxs)("div",{className:Q.footer,children:[(0,i.jsx)("strong",{children:"Part of an organization?"}),(0,i.jsxs)("span",{children:["Upgrade to"," ",(0,i.jsx)(O.A,{href:"https://github.com/github-copilot/business_signup/choose_business_type?cft=copilot_li.features_copilot.cfb",inline:!0,children:"Copilot Business"})," ","to enable across teams."]})]})]})}try{H.displayName||(H.displayName="QuotaExceededEmptyState")}catch{}var K=s(37937);let q={container:"QuotaMeterBanner-module__container--QJsKZ"};function J(){let{isLicensedLimited:e,chatQuotaRemaining:t}=(0,D.x)(),[s,n]=(0,h.useState)(()=>K.J.getMeterBannerFlag()??!1);if((0,h.useEffect)(()=>{if(e&&void 0!==t){let e=K.J.getMeterBannerFlag();t>0&&t<=10?null===e?(K.J.setMeterBannerFlag(!0),n(!0)):n(e):(K.J.removeMeterBannerFlag(),n(!1))}},[e,t]),!s||void 0===t)return null;let a=(0,i.jsx)(l.InfoIcon,{}),r=(0,i.jsx)(i.Fragment,{children:"You only have a few free responses remaining."}),c=(0,i.jsx)(P.z,{as:"a",href:"https://github.com/features/copilot#pricing",onClick:()=>{(0,o.BI)("dotcom_chat.activate",{target:"QUOTA_METER_BANNER_LINK_UPGRADE",mode:"assistive"})},children:"Upgrade"});return(0,i.jsx)("div",{className:q.container,children:(0,i.jsx)($,{icon:a,content:r,actions:c,onDismiss:()=>{K.J.setMeterBannerFlag(!1),n(!1)}})})}try{J.displayName||(J.displayName="QuotaMeterBanner")}catch{}var Y=s(10967);function V(){let{currentTopic:e}=(0,C.Pk)(),t=(0,j.P)(e),s=(0,j.Z6)(e),n=null;e&&s&&(n=`${e.ownerLogin}/${e.name}`);let a=t?e.repos:n?[n]:[],[o,r]=(0,Y.M8)(a),l=o.requestStatus===Y.xG.CanIndex&&(s&&o.code===Y.W5.Unindexed||t&&o.docs===Y.W5.Unindexed),c=(0,h.useRef)(!1);return(0,h.useEffect)(function(){let e=t?o.docs:o.code;!c.current&&e===Y.W5.Unindexed&&l&&(c.current=!0,r())},[o.code,o.docs,t,l,r]),(0,i.jsx)(i.Fragment,{})}try{V.displayName||(V.displayName="TopicIndexedMessage")}catch{}var Z=s(31806);function X(){let{currentTopic:e}=(0,C.Pk)(),t=(0,C.pn)(e=>e.currentReferences.find(e=>"docset"===e.type)),s=e??t,n=(0,h.useRef)(null);return s?(0,i.jsx)(Z.Z,{icon:(0,i.jsx)(l.RepoIcon,{}),topic:s,removeButtonRef:n}):null}try{X.displayName||(X.displayName="TopicIndicator")}catch{}var ee=s(70642),et=s(8932);function es({mode:e}){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.A,{sx:{height:"3rem",mb:2,display:"flex",justifyContent:"center"},children:(0,i.jsx)(et.A,{})}),(0,i.jsx)(p.A,{as:"h1",sx:{textAlign:"center",fontSize:3,mb:2},children:"Ask Copilot"}),(0,i.jsx)(u.A,{as:"p",sx:{textAlign:"center",color:"fg.muted",mb:"immersive"===e?5:3,px:3,textWrap:"balance"},children:"Select a repository to get started. Ask questions about your codebase to get answers fast and learn your way around."})]})}try{es.displayName||(es.displayName="ChatWithCopilotHeader")}catch{}var en=s(62456);function ei({docset:e,size:t}){return(0,i.jsx)(en.r,{src:e.avatarUrl,square:"organization"===e.ownerType,size:t})}try{ei.displayName||(ei.displayName="KnowledgeBaseAvatar")}catch{}var ea=s(70170),eo=s(67138),er=s(41980),el=s(96558),ec=s(59010);function ed(){let e=(0,N.b)(),{currentRepository:t,mode:s,selectedThreadID:n}=(0,C.Pk)(),[o,r]=(0,h.useState)(""),m=(0,ea.s)(e=>r(e),400,{start:!1}),[p,x]=(0,h.useState)(void 0),g=(0,h.useCallback)(()=>x(void 0),[]),f=(0,h.useCallback)(async t=>{if(g(),void 0===t){e.showTopicPicker(!1),e.clearCurrentTopic(),e.clearCurrentReferences(),"immersive"===s&&(0,a.kd)("/copilot"),n&&K.J.setSelectedTopic(n,null);return}await e.fetchCurrentRepo(Number(t)),e.showTopicPicker(!1)},[g,e,s,n]),{repositories:j,loading:y}=(0,er.U)(o,p,x,!0,t,4),b=(0,h.useMemo)(()=>y?"Loading repositories":0===j.length?"No repositories found":1===j.length?"1 repository found":`${j.length} repositories found`,[y,j.length]);return(0,i.jsxs)(c.A,{sx:{border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:2,display:"flex",flexDirection:"column",mb:3},children:[(0,i.jsx)(c.A,{sx:{p:3,pb:0},children:(0,i.jsx)(eo.A,{id:el.uN,leadingVisual:l.SearchIcon,name:"topic-search","aria-label":"Search repositories to chat about",placeholder:"Search repositories to chat about",onChange:e=>m(e.target.value),sx:{width:"100%","input:placeholder-shown":{textOverflow:"ellipsis"}}})}),(0,i.jsxs)(E.l,{children:[(0,i.jsx)("div",{role:"status",className:"sr-only",children:b}),y?(0,i.jsx)(c.A,{as:"li",sx:{display:"flex",justifyContent:"center",py:2,height:"190px",alignItems:"center"},children:(0,i.jsx)(d.A,{})}):0===j.length?(0,i.jsxs)(E.l.Item,{disabled:!0,children:[(0,i.jsx)(E.l.LeadingVisual,{sx:{color:"fg.muted"},children:(0,i.jsx)(l.CircleSlashIcon,{})}),(0,i.jsx)(u.A,{sx:{color:"fg.muted"},children:"No results found"})]}):(0,i.jsx)(i.Fragment,{children:j.length>0&&(0,i.jsxs)(E.l.Group,{children:[(0,i.jsx)(E.l.GroupHeading,{as:"h3",children:"Recent repositories"}),j.map(e=>(0,i.jsx)(ec.W,{repo:e,onSelect:f,trailingVisualComponent:(0,i.jsx)(l.ArrowRightIcon,{})},e.nwo))]})}),(0,i.jsx)(E.l.Divider,{sx:{marginInline:0}}),(0,i.jsxs)(E.l.Item,{id:"chat-with-no-context",onSelect:()=>f(void 0),sx:{"#chat-with-no-context--label":{marginBottom:"0px !important"}},children:["General purpose chat",(0,i.jsx)(E.l.TrailingVisual,{children:(0,i.jsx)(l.ArrowRightIcon,{})})]},"chat-with-no-context")]})]})}try{ed.displayName||(ed.displayName="TopicList")}catch{}let em=()=>{let e=(0,C.Pk)(),t=(0,h.useMemo)(()=>e.ssoOrganizations?e.ssoOrganizations.map(e=>e.login):[],[e.ssoOrganizations]);return(0,i.jsx)(c.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1,height:"100%"},children:(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,i.jsx)(es,{mode:e.mode}),(0,i.jsx)(c.A,{sx:{px:3,"> button":{m:"0 auto"}},children:(0,i.jsx)(ed,{})}),(0,i.jsx)(ee.x,{portalContainerName:L.E5,protectedOrgs:t,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${location.href}`,sx:{mx:3,mb:3}}),(0,i.jsx)(ep,{currentTopic:e.currentTopic})]})})};function ep({currentTopic:e}){return(0,j.P)(e)?(0,i.jsx)(c.A,{sx:{mt:3,mb:4},children:(0,i.jsx)(eu,{docset:e})}):null}function eu({docset:e}){return(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:3,border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:"var(--borderRadius-large)",padding:3},children:[(0,i.jsxs)(c.A,{sx:{display:"flex",alignItems:"baseline",gap:2},children:[(0,i.jsx)(ei,{docset:e,size:24}),(0,i.jsx)(p.A,{as:"h3",sx:{fontSize:1,m:0},children:e.name})," ",(0,i.jsx)(u.A,{sx:{fontSize:0,color:"fg.muted"},children:"Knowledge base added to conversation"})]}),(0,i.jsx)(p.A,{as:"h4",sx:{fontSize:0,m:0,color:"fg.muted",fontWeight:"500"},children:"Repositories in this knowledge base"}),(0,i.jsx)(c.A,{sx:{display:"flex",flexWrap:"wrap",gap:3},children:e.repos.map(e=>(0,i.jsxs)(c.A,{sx:{whiteSpace:"nowrap"},children:[(0,i.jsx)(l.RepoIcon,{}),` ${e}`]},e))})]})}try{em.displayName||(em.displayName="TopicPicker")}catch{}try{ep.displayName||(ep.displayName="TopicDescription")}catch{}try{eu.displayName||(eu.displayName="DocsetDescription")}catch{}let ex=({inputRef:e,showQuotaExceededEmptyState:t})=>{let s=(0,C.Pk)(),{showTopicPicker:n,streamingMessage:a}=s,o="immersive"===s.mode,{scrollToBottom:l}=(0,T.b)(),{messages:d,groupedMessages:m}=(0,f.a)(s);return(0,r.N)(()=>l("instant"),[l]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{className:"sr-only",children:"Copilot Chat"}),t?(0,i.jsx)(H,{}):n?(0,i.jsx)(em,{}):(0,i.jsx)(c.A,{sx:{display:"flex",flexDirection:"column",minHeight:"0",flexGrow:1},children:(0,i.jsxs)(c.A,{className:"copilot-messages-container",sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[0===d.length&&(0,i.jsx)("p",{className:k.legalText,children:(0,i.jsx)(W.h,{})}),!o&&!v.W.topicsAsReferences&&(0,i.jsx)(V,{}),m.map((t,n)=>(0,i.jsx)(R.i,{isLastGroup:n===m.length-1,children:t.map((o,r)=>{let l=n===m.length-1&&r===t.length-1;return(o===a||o.id===b.Wp||!eh(o)||!v.W.dotcomChatClientSideSkills||o.error||ef(o,l,s))&&(0,i.jsx)(S.c,{isLatestMessage:l,isFirstReply:1===d.length,isStreaming:o.id===a?.id,message:o,inputRef:e},r)})},n)),s.clientSkillConfirmation&&v.W.dotcomChatClientSideSkills&&(0,i.jsx)("div",{className:"m-3",children:(0,i.jsx)(I.m,{confirmation:s.clientSkillConfirmation,handleConfirmation:e=>s.clientSkillConfirmation?.onSubmit?.("accepted"===e.state),isLatestMessage:!0})})]})})]})},eh=e=>!e.content&&(!e.confirmations||0===e.confirmations.length)&&(!e.clientConfirmations||0===e.clientConfirmations.length),eg=e=>e.clientSkillsRequests&&e.clientSkillsRequests.length>0||e.clientToolResults&&e.clientToolResults.length>0,ef=(e,t,s)=>eg(e)&&t&&!s.streamingMessage&&!s.clientSkillConfirmation,ej=()=>(0,i.jsxs)(c.A,{sx:{m:"auto",display:"flex",flexDirection:"column",alignItems:"center",height:"100%",justifyContent:"center"},children:[(0,i.jsx)(d.A,{size:"large"}),(0,i.jsx)(c.A,{sx:{p:3,color:"fg.subtle"},children:"Loading conversation\u2026"})]}),ey=()=>{let{mode:e,reviewLab:t}=(0,C.Pk)();return(0,i.jsxs)(c.A,{sx:{display:"flex",gap:"2",alignItems:"center",py:3,pr:3,pl:"immersive"===e?3:2,color:"fg.subtle"},children:[(0,i.jsx)(x.A,{icon:l.AlertIcon}),"Failed to load previous messages.",t&&(0,i.jsx)(i.Fragment,{children:"\xa0You are in a review lab. Please check that you are connected to the Developer VPN."})]})},eb=({inputRef:e})=>{let t=(0,C.Pk)(),s=(0,N.b)(),{currentReferences:n,messagesLoading:r,messagesRestored:l,threadsLoading:d,currentTopic:m,messages:p,mode:u,selectedThreadID:x,showTopicPicker:f,context:b}=t,k=s.getSelectedThread(t),S=(0,h.useMemo)(()=>(0,j.k4)(Object.keys(A.Pe)).slice(0,4).map(e=>({heading:e,content:(0,j.k4)(A.Pe[e])[0]})),[]),{textAreaRef:R}=(0,g.Y)(e),{chatQuotaExceeded:I,isLicensedLimited:E,reloadQuota:M}=(0,D.x)(),{ambientError:B}=(0,C.Pk)();(0,h.useEffect)(()=>{if(!x||"assistive"===u)return;let e=`${j.Jz}/c/${x}`;window.location.pathname!==e&&0!==p.length&&(0,a.kd)(e)},[x,u,p.length]);let W=(0,h.useCallback)(async e=>{""!==e.trim()&&(M(),await s.sendChatMessage({thread:k,content:e,references:n,topic:m,context:b,customInstructions:t.customInstructions,skillOptions:t.skillOptions}))},[b,n,m,s,M,t.customInstructions,k,t.skillOptions]),P=l&&p.length>0,F="loading"===r.state&&t.selectedThreadID&&!f&&!P,U="error"===r.state||"error"===d.state,$="loaded"===r.state||P,O=I&&(f||!k),[Q]=(0,h.useState)(t.renderAttachKnowledgeBaseHerePopover),H=(0,y.B)(p),K=!!(!F&&!t.currentTopic&&!f&&0===H.length&&!Q&&0===n.length);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(T.$,{className:"copilot-chat-messages",style:{flex:"1 1 auto"},children:[F&&(0,i.jsx)(ej,{}),U&&(0,i.jsx)(ey,{}),$&&!F&&(0,i.jsx)(ex,{inputRef:R,showQuotaExceededEmptyState:O}),(0,i.jsx)(L.Cb,{})]}),K&&(0,i.jsx)(c.A,{className:"copilot-chat-messages",sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,px:3,mb:3,scrollbarGutter:"stable"},children:S.map((e,n)=>(0,i.jsx)(ev,{heading:e.heading,content:e.content,onSubmit:()=>{s.sendChatMessage({thread:s.getSelectedThread(t),content:e.content,references:t.currentReferences,topic:t.currentTopic,context:t.context}),(0,o.BI)("copilot_chat_suggestion_click",{topic:t.currentTopic?.name})}},n))}),!F&&!f&&!O&&(0,i.jsx)(c.A,{className:"copilot-chat-input copilot-chat-input-outer",sx:{display:"flex",flexDirection:"column",mt:"auto",px:3,pb:3,zIndex:1},children:I?(0,i.jsx)(G,{}):(0,i.jsxs)(i.Fragment,{children:[!K&&0===H.length&&!t.showTopicPicker&&(0,i.jsx)(z,{suggestionKind:"initial"}),(0,i.jsxs)("div",{children:[E&&(0,i.jsx)(J,{}),B&&(0,i.jsx)(_.P,{ambientError:B}),!v.W.topicsAsReferences&&(0,i.jsx)(X,{}),(0,i.jsx)(w.V,{textAreaRef:R,onSubmit:W,isStreaming:!!t.streamingMessage,size:"small"},x)]})]})}),(0,i.jsx)(L.zc,{})]})};function ev({heading:e,content:t,onSubmit:s}){return(0,i.jsxs)(m.Q,{sx:{bg:"canvas.default",height:"auto",minWidth:"auto",borderBottom:"1px solid",borderColor:"border.default",border:"1px solid var(--borderColor-default, var(--color-border-default))",flex:"1 1 49%",display:"flex",flexDirection:"column",justifyContent:"center",p:2},onClick:s,children:[(0,i.jsx)(p.A,{as:"h3",sx:{textAlign:"center",fontSize:1,m:0,mb:1,wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:e}),(0,i.jsx)(u.A,{as:"p",sx:{fontSize:0,fontWeight:400,textAlign:"center",color:"fg.muted",m:0,textWrap:"balance",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:t})]})}try{ex.displayName||(ex.displayName="Messages")}catch{}try{ej.displayName||(ej.displayName="Loading")}catch{}try{ey.displayName||(ey.displayName="Error")}catch{}try{eb.displayName||(eb.displayName="Chat")}catch{}try{ev.displayName||(ev.displayName="SuggestedPrompt")}catch{}},78176:(e,t,s)=>{s.d(t,{c:()=>B});var n=s(74848),i=s(64542),a=s(26514),o=s(62456),r=s(46988),l=s(34407),c=s(53949),d=s(38621),m=s(75177),p=s(52464),u=s(34164),x=s(96540),h=s(40650),g=s(82610),f=s(2622),j=s(65615),y=s(7426),b=s(1088),v=s(79929),C=s(72659),N=s(66349),A=s(72160),_=s(67264),k=s(61982),w=s(47920),S=s(32132),R=s(79887),T=s(82005),I=s(4181),E=s(50260);let M=({isLatestMessage:e,isFirstReply:t,isStreaming:s,...M})=>{let{message:B}=(0,C.V)(),z=(0,j.Pk)(),W=(0,y.b)(),{author:L,handleConfirmationAction:D,handleRetryErrorMessage:P,hasClientConfirmations:F,isAI:U,isCopilot:$,isError:G,isAgentError:O,isInterrupted:Q,isLoading:H,isUser:K,myRef:q,onFeedbackSubmitted:J,rendererConfig:Y,renderFeedback:V,shouldShowMessageActions:Z,skillExecutionToUseForRespondingText:X,showRetryButton:ee}=(0,h.p)({excludeFeedback:M.excludeFeedback,inputRef:M.inputRef,isLatestMessage:e,isLoading:M.isLoading,isStreaming:s,excludeReferencesFromFocusZone:!0}),et=B.clientToolResults&&B.clientToolResults.length>0,es=B.clientSkillsRequests&&B.clientSkillsRequests.length>0,en=K&&!et,ei=H||et||es,ea=ei&&e,eo=$||et,er=(0,x.useMemo)(()=>(0,g.rT)(B.references??[]),[B.references]),el=(0,x.useMemo)(()=>W.maxMessagesReached(),[W]),ec=er.filter(e=>"image"!==e.type&&"org-instructions"!==e.type),ed=(0,x.useMemo)(()=>B.mediaContent?.find(e=>e.mediaType.startsWith("image/")),[B.mediaContent]),em=(0,x.useMemo)(()=>f.W.attachImagesImmersive&&void 0!==ed||!1,[ed]),ep=f.W.copilotUIRefs,eu=(0,x.useCallback)(e=>{let t=e.target.href,s=er.find(e=>e.url===t);s&&"immersive"===z.mode&&(W.selectReference(s),e.preventDefault())},[W,er,z.mode]),ex=(0,x.useCallback)(e=>{W.setWrapCodeLines(e)},[W]);return(0,n.jsxs)("div",{className:(0,u.$)("message-container",v.A.messageContainer,en&&v.A.user,U&&v.A.ai),ref:q,...(0,c.G)(`message-${G?"error":s?"streaming":B.id}`),children:[en&&em&&(0,n.jsx)(b.o,{src:ed?.url||"",alt:"Uploaded image",mode:z.mode}),eo||et?(0,n.jsx)(_.W,{isLoading:ei&&e,isError:G&&B.error?.type!=="agentUnauthorized",mode:z.mode,isFirstMessage:t,isLoadingSkills:(B.skillExecutions??[]).length>0&&ei&&""===B.content&&e,message:B.content||"",createdAt:B.createdAt}):U?(0,n.jsx)("div",{className:v.A.avatar,children:(0,n.jsx)(o.r,{src:L.avatarURL,size:24,"aria-label":`${L.name} avatar`,alt:`${L.name} avatar`,"data-testid":"chat-message-author-avatar"})}):null,en&&(0,n.jsx)(N.t,{size:"small",align:"right",className:"mb-2",references:ec}),(0,n.jsxs)("div",{className:(0,u.$)(v.A.message,en&&v.A.user),children:[F&&B.clientConfirmations?.length?(0,n.jsx)(m.A,{className:"my-1",sx:{display:"flex",alignItems:"baseline",justifyContent:en?"flex-end":""},"data-testid":"chat-message-client-confirmations",children:(0,n.jsxs)(p.A,{sx:{fontWeight:"normal",color:"var(--fgColor-muted)"},children:[(0,n.jsx)(d.CheckIcon,{})," ",L.name," ",B.clientConfirmations?.[0]?.state," the action"]})}):null,$&&ea&&!B.content&&(0,n.jsx)(E.b,{className:(0,u.$)(v.A.skillExecutionText,"mb-2 mt-1 ml-2"),children:`${(0,S.WA)(X)}...`}),(0,n.jsx)("div",{className:(0,u.$)(v.A.messageContent,!!F&&v.A.hasClientConfirmations),children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(m.A,{className:"js-snippet-clipboard-copy-unpositioned",sx:{fontSize:1,px:2,py:1,zIndex:1,".snippet-clipboard-content":{position:"relative",overflow:"auto",display:"flex",justifyContent:"space-between",backgroundColor:"canvas.subtle",marginBottom:3,zIndex:1,pre:{marginBottom:0},"clipboard-copy":{width:"28px",height:"28px"}}},children:["assistant"===B.role&&B.content&&(er?.length?(0,n.jsx)(N.s,{className:"mb-2",references:er}):null),$&&M.isLoading?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.O,{variant:"rounded",height:"12px",width:"random"}),(0,n.jsx)(l.O,{variant:"rounded",height:"12px",width:"random"}),(0,n.jsx)(l.O,{variant:"rounded",height:"12px",width:"random"})]}):!F&&(en?(0,n.jsx)(I.R,{children:B.content??""}):B.content&&(0,n.jsx)(i.To,{markdown:B.content,onLinkClick:eu,chatMode:"assistive",wrapCodeLines:z.wrapCodeLines,onWrapCodeLinesChange:ex,...Y})),G?(0,n.jsx)(k.K,{manager:W}):null,O&&B.agentErrors?.length&&!ep?(0,n.jsx)(k.h,{errors:B.agentErrors}):null,Q?(0,n.jsx)(R.h,{messageHasContent:!!B.content||!!B.skillExecutions?.length}):null,($||(0,g.yh)(L))&&(0,g.Ye)(B.confirmations).map((t,s)=>"indexrepo"===t.confirmation.name?null:(0,n.jsx)(A.m,{confirmation:t,handleConfirmation:D,isLatestMessage:e},s))]}),!Z&&ee&&(0,n.jsx)(T.$,{handleRetryMessage:P,disabled:el}),Z&&(0,n.jsxs)(m.A,{className:"message-actions","data-testid":"message-action-bar",sx:{display:"inline-flex",alignItems:"center",position:e?void 0:"absolute",bottom:e?void 0:"-2.25rem",borderRadius:e?void 0:2,boxShadow:e?void 0:"var(--shadow-floating-small)",opacity:e?void 0:0,pointerEvents:e?void 0:"none","&::before":{content:e?void 0:'""',inset:"-0.5rem -0.75rem",zIndex:-1,position:"absolute"}},children:[V&&(0,n.jsx)(w.G,{iconSize:"small",returnFocusRef:q,onFeedbackSubmitted:J}),$&&!!B.content&&!s&&(0,n.jsx)(a.T,{textToCopy:B.content??"",ariaLabel:"Copy to clipboard",size:"small",className:"d-flex flex-items-center",onCopy:()=>{(0,r.BI)("copilot_chat.activate",{target:"CHAT_MESSAGE_COPY",mode:z.mode})}}),ee&&(0,n.jsx)(T.$,{handleRetryMessage:P,disabled:el})]})]})})]})]})},B=({message:e,...t})=>(0,n.jsx)(C.$,{message:e,children:(0,n.jsx)(M,{...t})});try{M.displayName||(M.displayName="InnerChatMessage")}catch{}try{B.displayName||(B.displayName="ChatMessage")}catch{}},62064:(e,t,s)=>{s.d(t,{v:()=>m});var n,i=s(74848),a=s(96884),o=s(87330),r=s(94977),l=s(96540);let c=e=>` ${e.split(" ").map(e=>`<${e.replaceAll("Mod",(0,a.U0)()?"Cmd":"Ctrl").replaceAll("Command","Cmd").replaceAll("Control","Ctrl").toLowerCase()}>`).join(" / ")}`,d=e=>e.replaceAll("{CMD_CTRL}",(0,a.U0)()?"Command":"Control"),m=(0,l.forwardRef)(({label:e,hideTooltip:t,icon:s,shortcut:n,sx:a,tooltipDirection:m,...p},u)=>{let x=(0,l.useCallback)(()=>{let a={display:"flex"};return m?.includes("w")&&(a={...a,pl:2,ml:-2}),m?.includes("e")&&(a={...a,pr:2,mr:-2}),m?.includes("s")&&(a={...a,pb:2,mb:-2}),(m?.includes("n")||!m)&&(a={...a,pt:2,mt:-2}),t?(0,i.jsx)(s,{}):(0,i.jsx)(r.A,{"aria-label":`${e}${n?c(n):""}`,className:"icon-button-with-tooltip__tooltip",direction:m,sx:a,children:(0,i.jsx)(s,{})})},[t,e,n,m,s]);return(0,i.jsx)(o.K,{unsafeDisableTooltip:!0,ref:u,icon:x,"aria-keyshortcuts":n?d(n):void 0,sx:{...a,"&:focus-visible, &:hover":{"& .icon-button-with-tooltip__tooltip":{"&::after, &::before":{display:"inline-block",textDecoration:"none",animationName:"tooltip-appear",animationDuration:"0.1s",animationFillMode:"forwards",animationTimingFunction:"ease-in"}}},"&:hover .icon-button-with-tooltip__tooltip":{"&::after, &::before":{animationDelay:"0.4s"}}},...p,"aria-label":e})});m.displayName="IconButtonWithTooltip";try{(n=TooltippedIcon).displayName||(n.displayName="TooltippedIcon")}catch{}}}]);
//# sourceMappingURL=ui_packages_copilot-chat_components_Chat_tsx-ui_packages_icon-button-with-tooltip_IconButtonW-1ba5d9-1f2ca098db10.js.map